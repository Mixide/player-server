(function(){"use strict";var e={7049:function(e,a,t){var s=t(5130),n=t(6768);function r(e,a,t,s,r,o){const l=(0,n.g2)("NavBar"),i=(0,n.g2)("router-view");return(0,n.uX)(),(0,n.CE)(n.FK,null,[(0,n.bF)(l),(0,n.bF)(i)],64)}const o={class:"navbar navbar-expand-lg bg-body-tertiary"},l={class:"container-fluid"},i=(0,n.Lk)("a",{class:"navbar-brand",href:"#"},"在线音乐",-1),c=(0,n.Lk)("button",{class:"navbar-toggler",type:"button","data-bs-toggle":"collapse","data-bs-target":"#navbarText","aria-controls":"navbarText","aria-expanded":"false","aria-label":"Toggle navigation"},[(0,n.Lk)("span",{class:"navbar-toggler-icon"})],-1),u={class:"collapse navbar-collapse",id:"navbarText"},d={class:"navbar-nav me-auto mb-2 mb-lg-0"},p={class:"nav-item"},m={class:"navbar-nav"},v={class:"nav-item"},f={class:"nav-item"};function b(e,a,t,s,r,b){const g=(0,n.g2)("router-link");return(0,n.uX)(),(0,n.CE)("nav",o,[(0,n.Lk)("div",l,[i,c,(0,n.Lk)("div",u,[(0,n.Lk)("ul",d,[(0,n.Lk)("li",p,[(0,n.bF)(g,{class:"nav-link",to:{name:"musicspace"}},{default:(0,n.k6)((()=>[(0,n.eW)("音乐空间")])),_:1})])]),(0,n.Lk)("ul",m,[(0,n.Lk)("li",v,[(0,n.bF)(g,{class:"nav-link",to:{name:"login"}},{default:(0,n.k6)((()=>[(0,n.eW)("登录")])),_:1})]),(0,n.Lk)("li",f,[(0,n.bF)(g,{class:"nav-link",to:{name:"register"}},{default:(0,n.k6)((()=>[(0,n.eW)("注册")])),_:1})])])])])])}var g=t(1387),h=t(4232);const k=e=>((0,n.Qi)("data-v-2aecec12"),e=e(),(0,n.jt)(),e),L={class:"row justify-content-md-center"},y={class:"col-3"},w={class:"mb-3"},_=k((()=>(0,n.Lk)("label",{for:"username",class:"form-label"},"用户名",-1))),C={class:"mb-3"},F=k((()=>(0,n.Lk)("label",{for:"password",class:"form-label"},"密码",-1))),E={class:"error-message"},A=k((()=>(0,n.Lk)("button",{type:"submit",class:"btn btn-primary"},"登录",-1)));function S(e,a,t,r,o,l){const i=(0,n.g2)("Content");return(0,n.uX)(),(0,n.Wv)(i,null,{default:(0,n.k6)((()=>[(0,n.eW)(" 登录 "),(0,n.Lk)("div",L,[(0,n.Lk)("div",y,[(0,n.Lk)("form",{onSubmit:a[2]||(a[2]=(0,s.D$)(((...e)=>l.handleLogin&&l.handleLogin(...e)),["prevent"]))},[(0,n.Lk)("div",w,[_,(0,n.bo)((0,n.Lk)("input",{"onUpdate:modelValue":a[0]||(a[0]=e=>o.username=e),type:"text",class:"form-control",id:"username",required:""},null,512),[[s.Jo,o.username]])]),(0,n.Lk)("div",C,[F,(0,n.bo)((0,n.Lk)("input",{"onUpdate:modelValue":a[1]||(a[1]=e=>o.password=e),type:"password",class:"form-control",id:"password",required:""},null,512),[[s.Jo,o.password]])]),(0,n.Lk)("div",E,(0,h.v_)(o.error_message),1),A],32)])])])),_:1})}t(4114);var O=t(782);const j={class:"container"},I={class:"card"},x={class:"card-body"};function U(e,a,t,s,r,o){return(0,n.uX)(),(0,n.CE)("div",j,[(0,n.Lk)("div",I,[(0,n.Lk)("div",x,[(0,n.RG)(e.$slots,"default",{},void 0,!0)])])])}var R={name:"Content"},X=t(1241);const T=(0,X.A)(R,[["render",U],["__scopeId","data-v-aa710796"]]);var W=T,q={name:"Login",components:{Content:W},data(){return{username:"",password:"",error_message:""}},methods:{...(0,O.i0)(["login"]),handleLogin(){this.login({username:this.username,password:this.password,success:e=>{-1==e.data.code?alert(e.data.msg):this.$router.push("/")},error:()=>{console.error("登录失败")}})}}};const M=(0,X.A)(q,[["render",S],["__scopeId","data-v-2aecec12"]]);var J=M;const K=e=>((0,n.Qi)("data-v-9483a5e4"),e=e(),(0,n.jt)(),e),N=K((()=>(0,n.Lk)("div",{id:"aplayer"},null,-1))),P={class:"row"},V={class:"col-3"},B={class:"col-9"};function $(e,a,t,s,r,o){const l=(0,n.g2)("UserInfo"),i=(0,n.g2)("Upload"),c=(0,n.g2)("MusicList"),u=(0,n.g2)("Content");return(0,n.uX)(),(0,n.CE)(n.FK,null,[N,(0,n.bF)(u,null,{default:(0,n.k6)((()=>[(0,n.Lk)("div",P,[(0,n.Lk)("div",V,[(0,n.bF)(l,{user:s.user},null,8,["user"]),(0,n.bF)(i,{id:s.user.id},null,8,["id"])]),(0,n.Lk)("div",B,[(0,n.bF)(c,{list:s.music_list,ap:s.ap},null,8,["list","ap"])])])])),_:1})],64)}const D={class:"card"},Q={class:"card-body"},G={class:"row"},z={class:"col-3"},H=["src"],Y={class:"col-9"},Z={class:"username"},ee={class:"music-nums"};function ae(e,a,t,s,r,o){return(0,n.uX)(),(0,n.CE)("div",D,[(0,n.Lk)("div",Q,[(0,n.Lk)("div",G,[(0,n.Lk)("div",z,[(0,n.Lk)("img",{class:"img-fluid",src:t.user.photo},null,8,H)]),(0,n.Lk)("div",Y,[(0,n.Lk)("div",Z,(0,h.v_)(t.user.username),1),(0,n.Lk)("div",ee,"音乐数:"+(0,h.v_)(t.user.music_nums),1)])])])])}var te={name:"UserInfo",props:{user:{type:Object,required:!0}}};const se=(0,X.A)(te,[["render",ae],["__scopeId","data-v-d775a13a"]]);var ne=se;const re={class:"card list"},oe={class:"card-body"},le=["onClick"],ie={class:"card music"},ce={class:"card-body"},ue={class:"row"},de={class:"col-10 music_name"},pe={class:"col-2 artist"};function me(e,a,t,s,r,o){return(0,n.uX)(),(0,n.CE)("div",re,[(0,n.Lk)("div",oe,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(t.list.musics,((e,a)=>((0,n.uX)(),(0,n.CE)("div",{key:a,onClick:e=>o.handleCardClick(a)},[(0,n.Lk)("div",ie,[(0,n.Lk)("div",ce,[(0,n.Lk)("div",ue,[(0,n.Lk)("div",de,(0,h.v_)(e.name),1),(0,n.Lk)("div",pe,"歌手："+(0,h.v_)(e.artist),1)])])])],8,le)))),128))])])}var ve={name:"MusicList",props:{list:{type:Object,required:!0},ap:{type:Object,required:!0}},watch:{ap:{}},methods:{handleCardClick(e){this.ap.value.pause(),this.ap.value.list.switch(e),this.ap.value.play()}}};const fe=(0,X.A)(ve,[["render",me],["__scopeId","data-v-040541d1"]]);var be=fe;const ge=e=>((0,n.Qi)("data-v-645eda74"),e=e(),(0,n.jt)(),e),he={class:"card upload-music"},ke={class:"card-body"},Le={class:"mb-3"},ye=ge((()=>(0,n.Lk)("label",{for:"formFileMultiple",class:"form-label"},"上传音乐",-1)));function we(e,a,t,s,r,o){return(0,n.uX)(),(0,n.CE)("div",he,[(0,n.Lk)("div",ke,[(0,n.Lk)("div",Le,[ye,(0,n.Lk)("input",{class:"form-control",type:"file",id:"formFile",onChange:a[0]||(a[0]=(...e)=>o.handleFileChange&&o.handleFileChange(...e))},null,32),(0,n.Lk)("button",{type:"button",class:"btn btn-primary btn-sm",onClick:a[1]||(a[1]=(...e)=>o.uploadFiles&&o.uploadFiles(...e))},"上传")])])])}var _e=t(4373);const Ce=e=>_e.A.get("http://localhost:8000/api/music/",{params:{userid:e}}),Fe=(e,a)=>(e.append("userid",a),_e.A.post("http://localhost:8000/api/upload/",e,{headers:{"Content-Type":"multipart/form-data"}})),Ee=(e,a)=>_e.A.post("http://localhost:8000/api/user/login/",{username:e,password:a}),Ae=(e,a)=>_e.A.post("http://localhost:8000/api/user/register/",{username:e,password:a});var Se={name:"Upload",props:{id:{type:Object,required:!0}},data(){return{files:[]}},methods:{handleFileChange(e){this.files=Array.from(e.target.files)},uploadFiles(){if(this.files.length>0){const e=new FormData;this.files.forEach((a=>{e.append("file",a)})),Fe(e,this.id).then((e=>{console.log("文件上传成功",e),window.location.reload()})).catch((e=>{console.error("文件上传失败",e)}))}}}};const Oe=(0,X.A)(Se,[["render",we],["__scopeId","data-v-645eda74"]]);var je=Oe,Ie=t(2333),xe=t.n(Ie),Ue=t(144),Re={name:"MusicSpace",components:{Content:W,UserInfo:ne,MusicList:be,Upload:je},data(){return{info:{fixed:!1,listFolded:!0,autoplay:!1,preload:"none",loop:"all",order:"list"}}},setup(){const e=(0,O.Pj)(),a=(0,Ue.KR)(e.getters.user||JSON.parse(localStorage.getItem("user"))||{id:1,username:"test",photo:"http://localhost:8000/static/image/photo.ico",music_nums:0}),t=(0,Ue.KR)({musics:[]});let s=(0,Ue.KR)(null);const r=async()=>{try{const e=await Ce(a.value.id);t.value.musics=e.data,a.value.music_nums=e.data.length,s.value=(0,Ue.KR)(new(xe())({container:document.getElementById("aplayer"),audio:e.data,fixed:!1,listFolded:!0,autoplay:!1,preload:"auto",loop:"all",order:"list"}))}catch(e){console.error("Error fetching data:",e)}};return(0,n.sV)((()=>{r()})),{user:a,music_list:t,ap:s}}};const Xe=(0,X.A)(Re,[["render",$],["__scopeId","data-v-9483a5e4"]]);var Te=Xe;const We={class:"row justify-content-md-center"},qe={class:"col-3"},Me={class:"mb-3"},Je=(0,n.Lk)("label",{for:"username",class:"form-label"},"用户名",-1),Ke={class:"mb-3"},Ne=(0,n.Lk)("label",{for:"password",class:"form-label"},"密码",-1),Pe=(0,n.Lk)("button",{type:"submit",class:"btn btn-primary"},"注册",-1);function Ve(e,a,t,r,o,l){const i=(0,n.g2)("Content");return(0,n.uX)(),(0,n.Wv)(i,null,{default:(0,n.k6)((()=>[(0,n.eW)(" 注册 "),(0,n.Lk)("div",We,[(0,n.Lk)("div",qe,[(0,n.Lk)("form",{onSubmit:a[2]||(a[2]=(0,s.D$)(((...e)=>l.submit&&l.submit(...e)),["prevent"]))},[(0,n.Lk)("div",Me,[Je,(0,n.bo)((0,n.Lk)("input",{"onUpdate:modelValue":a[0]||(a[0]=e=>o.username=e),type:"text",class:"form-control",id:"username"},null,512),[[s.Jo,o.username]])]),(0,n.Lk)("div",Ke,[Ne,(0,n.bo)((0,n.Lk)("input",{"onUpdate:modelValue":a[1]||(a[1]=e=>o.password=e),type:"password",class:"form-control",id:"password"},null,512),[[s.Jo,o.password]])]),Pe],32)])])])),_:1})}var Be={name:"Register",components:{Content:W},data(){return{username:"",password:""}},methods:{submit(){Ae(this.username,this.password).then((e=>{alert(e.data.msg)})).catch((e=>{console.error("注册失败",e)}))}}};const $e=(0,X.A)(Be,[["render",Ve]]);var De=$e;function Qe(e,a,t,s,r,o){const l=(0,n.g2)("Content");return(0,n.uX)(),(0,n.Wv)(l,null,{default:(0,n.k6)((()=>[(0,n.eW)(" 404 ")])),_:1})}var Ge={name:"NotFound",components:{Content:W}};const ze=(0,X.A)(Ge,[["render",Qe]]);var He=ze,Ye=new O.Ay.Store({state:{user:"undefined"!=localStorage.getItem("user")?JSON.parse(localStorage.getItem("user")):null},mutations:{SET_USER(e,a){e.user=a,localStorage.setItem("user",JSON.stringify(a))},CLEAR_USER(e){e.user=null,localStorage.removeItem("user")}},actions:{async login({commit:e},{username:a,password:t,success:s,error:n}){try{const n=await Ee(a,t),r=n.data.userinfo;e("SET_USER",r),s(n)}catch(r){n()}},logout({commit:e}){e("CLEAR_USER")}},getters:{isLoggedIn:e=>!!e.user,user:e=>e.user}});const Ze=[{path:"/",name:"musicspace",component:Te,meta:{requiresAuth:!0}},{path:"/login/",name:"login",component:J},{path:"/register/",name:"register",component:De},{path:"/404/",name:"404",component:He},{path:"/:catchAll(.*)",redirect:"/404/"}],ea=(0,g.aE)({history:(0,g.LA)(),routes:Ze});ea.beforeEach(((e,a,t)=>{e.matched.some((e=>e.meta.requiresAuth))?Ye.getters.isLoggedIn?t():t("/login"):t()}));var aa=ea,ta={name:"NavBar"};const sa=(0,X.A)(ta,[["render",b]]);var na=sa,ra={name:"App",components:{NavBar:na}};const oa=(0,X.A)(ra,[["render",r]]);var la=oa;(0,s.Ef)(la).use(Ye).use(aa).mount("#app")}},a={};function t(s){var n=a[s];if(void 0!==n)return n.exports;var r=a[s]={exports:{}};return e[s].call(r.exports,r,r.exports,t),r.exports}t.m=e,function(){var e=[];t.O=function(a,s,n,r){if(!s){var o=1/0;for(u=0;u<e.length;u++){s=e[u][0],n=e[u][1],r=e[u][2];for(var l=!0,i=0;i<s.length;i++)(!1&r||o>=r)&&Object.keys(t.O).every((function(e){return t.O[e](s[i])}))?s.splice(i--,1):(l=!1,r<o&&(o=r));if(l){e.splice(u--,1);var c=n();void 0!==c&&(a=c)}}return a}r=r||0;for(var u=e.length;u>0&&e[u-1][2]>r;u--)e[u]=e[u-1];e[u]=[s,n,r]}}(),function(){t.n=function(e){var a=e&&e.__esModule?function(){return e["default"]}:function(){return e};return t.d(a,{a:a}),a}}(),function(){t.d=function(e,a){for(var s in a)t.o(a,s)&&!t.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:a[s]})}}(),function(){t.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){t.o=function(e,a){return Object.prototype.hasOwnProperty.call(e,a)}}(),function(){t.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={524:0};t.O.j=function(a){return 0===e[a]};var a=function(a,s){var n,r,o=s[0],l=s[1],i=s[2],c=0;if(o.some((function(a){return 0!==e[a]}))){for(n in l)t.o(l,n)&&(t.m[n]=l[n]);if(i)var u=i(t)}for(a&&a(s);c<o.length;c++)r=o[c],t.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return t.O(u)},s=self["webpackChunkplayer_web"]=self["webpackChunkplayer_web"]||[];s.forEach(a.bind(null,0)),s.push=a.bind(null,s.push.bind(s))}();var s=t.O(void 0,[504],(function(){return t(7049)}));s=t.O(s)})();
//# sourceMappingURL=app.f45d75e7.js.map